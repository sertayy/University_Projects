import pickle
import json

if __name__ == "__main__":
    with open("../old_files/reviews_6_6.pickle", "rb") as p:
        reviews_pickle = pickle.load(p)
    berkay = {
        (1, 21): 1,
        (1, 22): 3,
        (1, 23): 2,
        (1, 24): 2,
        (1, 25): 1,
        (1, 26): 2,
        (1, 27): 1,
        (1, 28): 4,
        (1, 29): 2,
        (1, 30): 1,
        (1, 31): 1,
        (1, 32): 3,
        (1, 33): 3,
        (1, 34): 1,
        (1, 35): 3,
        (1, 36): 1,
        (1, 37): 3,
        (1, 38): 2,
        (1, 39): 4,
        (1, 40): 4,
        (1, 41): 3,
        (1, 42): 2,
        (1, 43): 2,
        (1, 44): 4,
        (1, 45): 1,
        (1, 46): 1,
        (1, 47): 2,
        (1, 48): 2,
        (1, 50): 4,
        (1, 51): 2,
        (1, 52): 4,
        (1, 53): 4,
        (1, 54): 2,
        (1, 55): 2,
        (1, 56): 3,
        (1, 57): 2,
        (1, 58): 2,
        (1, 59): 2,
        (1, 60): 1,
        (1, 61): 1,
        (1, 62): 1,
        (1, 63): 4,
        (1, 64): 3,
        (1, 65): 2,
        (1, 66): 2,
        (1, 67): 2,
        (1, 68): 2,
        (1, 69): 2,
        (1, 70): 1,
        (1, 71): 3,
        (1, 72): 4,
        (1, 73): 2,
        (1, 74): 1,
        (1, 75): 1,
        (1, 76): 3,
        (1, 77): 3,
        (1, 78): 1,
        (1, 79): 2,
        (1, 80): 2,
        (1, 81): 3,
        (1, 82): 3,
        (1, 83): 3,
        (1, 84): 1,
        (1, 85): 3,
        (1, 86): 2,
        (1, 87): 1,
        (1, 88): 2,
        (1, 89): 2,
        (1, 90): 3,
        (1, 91): 4,
        (1, 92): 3,
        (1, 93): 1,
        (1, 94): 3,
        (1, 95): 2,
        (1, 96): 3,
        (1, 97): 1,
        (1, 98): 2,
        (1, 99): 2,
        (1, 100): 2,
        (1, 101): 1,
        (1, 102): 1,
        (1, 103): 2,
        (1, 104): 2,
        (1, 105): 2,
        (1, 106): 1,
        (1, 107): 1,
        (1, 108): 2,
        (1, 109): 2,
        (1, 110): 1,
        (1, 111): 2,
        (1, 112): 3,
        (1, 113): 1,
        (1, 114): 1,
        (1, 115): 3,
        (1, 116): 3,
        (1, 117): 2,
        (1, 118): 3,
        (1, 119): 3,
        (1, 120): 3,
        (1, 121): 2,
        (1, 122): 1,
        (1, 123): 2,
        (1, 124): 4,
        (1, 125): 2,
        (1, 126): 3,
        (4, 0): 1,
        (4, 1): 2,
        (4, 2): 1,
        (4, 3): 1,
        (4, 4): 3,
        (4, 5): 1,
        (4, 6): 1,
        (4, 7): 3,
        (4, 8): 1,
        (4, 9): 1,
        (4, 10): 1,
        (4, 11): 3,
        (4, 12): 1,
        (4, 13): 4,
        (4, 14): 1,
        (4, 15): 3,
        (4, 16): 3,
        (4, 18): 1,
        (4, 19): 1,
        (4, 20): 1,
        (4, 21): 1,
        (4, 22): 4,
        (4, 23): 3,
        (4, 24): 4,
        (4, 25): 1,
        (4, 26): 1,
        (4, 27): 1,
        (4, 28): 1,
        (4, 29): 1,
        (4, 30): 1,
        (4, 31): 1,
        (4, 32): 2,
        (4, 33): 1,
        (4, 34): 4,
        (4, 35): 1,
        (4, 36): 1,
        (4, 37): 2,
        (4, 38): 1,
        (4, 39): 1,
        (4, 40): 1,
        (4, 41): 2,
        (4, 42): 3,
        (4, 43): 1,
        (4, 44): 1,
        (4, 45): 1,
        (4, 46): 3,
        (4, 47): 1,
        (4, 48): 1,
        (4, 49): 1,
        (4, 50): 1,
        (4, 51): 1,
        (4, 52): 1,
        (4, 53): 2,
        (4, 54): 1,
        (4, 55): 3,
        (4, 56): 4,
        (4, 57): 1,
        (4, 58): 1,
        (4, 59): 1,
        (4, 60): 4,
        (4, 61): 1,
        (4, 62): 3,
        (4, 63): 1,
        (4, 64): 2,
        (4, 65): 3,
        (4, 66): 4,
        (4, 67): 1,
        (4, 68): 4,
        (4, 69): 1,
        (4, 70): 3,
        (4, 71): 1,
        (4, 72): 1,
        (4, 73): 1,
        (4, 74): 1,
        (4, 75): 1,
        (4, 76): 2,
        (4, 77): 2,
        (4, 78): 2
    }

    son = []
    for pair in berkay:
        rev = reviews_pickle[pair[0]][pair[1]]
        rat = pair[0]
        cat_num = berkay[pair]
        if cat_num == 1:
            cat = "ratings"
        elif cat_num == 2:
            cat = "user experience"
        elif cat_num == 3:
            cat = "feature request"
        else:
            cat = "bug report"
        son.append({
            "review": rev,
            "rating": rat,
            "category": cat
        })
    with open("../output/big_query_6_6.json", "w") as out:
        json.dump(son, out, ensure_ascii=False, indent=4)
